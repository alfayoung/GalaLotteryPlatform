import{_ as M}from"./登出-0a221aa0.js";import{_ as T,u as C,g as W,r as U,a as b,b as u,c as L,w as A,h as m,i as j,m as v,W as q,E as x,e,H as B,d as n,F as z}from"./index-13fd0748.js";const D=["src"],V={__name:"UploadPhoto",setup(N){const r=C(),{proxy:P}=W(),R=["image/bmp","image/gif","image/jpg","image/jpeg","image/png"],_=U(r.head),g=U(null);let f=null;const F=function(a){return new Promise((l,c)=>{const t=new Image,o=new FileReader;o.onload=function(s){t.src=s.target.result},o.onerror=function(s){c(s)},o.readAsDataURL(a),t.onload=function(){l(t)},t.onerror=function(s){c(s)}})},H=async a=>(f=new Promise(async(l,c)=>{if(R.includes(a.raw.type)){if(a.size/1024/1024>4)return x.error("上传文件大小不能超过 4M"),!1}else return x.error("上传文件格式务必 PNG|JPG"),!1;const t=await F(a.raw),o=document.createElement("canvas"),s=o.getContext("2d"),{width:i,height:d}=t,y=200,w=200;let p=i,h=d;(i>y||d>w)&&(i/d>1?(p=y,h=Math.round(y*(d/i))):(h=w,p=Math.round(w*(i/d)))),o.width=p,o.height=h,s&&(s.clearRect(0,0,p,h),s.drawImage(t,0,0,p,h));const k=await new Promise(E=>o.toBlob(E,a.raw.type));g.value=k,_.value=URL.createObjectURL(k),console.log(g.value),l(!0)}),f),I=async()=>{f&&await f;const a=new FileReader;a.onload=l=>{const c=l.target.result,t=new Uint8Array(c),o=Array.from(t);console.log("Length of profile: ",o.length);const s={jAccount:r.jAccount,profile:o},i={"Content-Type":"application/json"};return P.$axios.post("/api/uploadProfile",s,i)},a.readAsArrayBuffer(g.value),r.updateHead(URL.createObjectURL(g.value)),x.success("上传头像成功")};return(a,l)=>{const c=b("el-icon"),t=b("el-upload");return u(),L(t,{class:"avatar-uploader",action:"string","show-file-list":!1,"on-change":H,"http-request":I},{default:A(()=>[_.value?(u(),m("img",{key:0,src:_.value,class:"avatar"},null,8,D)):(u(),L(c,{key:1,class:"avatar-uploader-icon"},{default:A(()=>[j(v(q))]),_:1}))]),_:1})}}},$=T(V,[["__scopeId","data-v-0520f7ba"]]);const G={id:"info"},J=e("div",null,[e("p",{style:{"font-size":"15px",width:"100vw","text-align":"center",position:"relative",top:"7vh"}},[n(" 点击头像可更换"),e("br"),n("Cliquez sur la photo pour la changer ")])],-1),O={class:"center"},S=e("h2",{class:"form",style:{"text-align":"right"}},[n("用户名"),e("br"),n("Nom d'utilisateur")],-1),K={class:"in"},Q={class:"center"},X=e("h2",{class:"form"},"jAccount",-1),Y={class:"in"},Z={class:"center"},ee=e("h2",{class:"form",style:{"text-align":"right"}},[n("抽奖状态"),e("br"),n("Tirage au sort")],-1),te={key:0,class:"in"},oe=e("br",null,null,-1),se={key:1,class:"in"},ae=e("br",null,null,-1),ne=e("img",{src:M,alt:"",id:"logout"},null,-1),ie={__name:"userinfo",setup(N){const r=C();return r.init(),(P,R)=>{const _=b("RouterLink");return u(),m(z,null,[e("div",G,[J,e("div",null,[j($,{id:"upload",class:"center"})]),e("div",O,[S,e("p",K,B(v(r).userName),1)]),e("div",Q,[X,e("p",Y,B(v(r).jAccount),1)]),e("div",Z,[ee,v(r).isJoin?(u(),m("p",te,[n("已参与"),oe,n("Déjà participé")])):(u(),m("p",se,[n("未参与"),ae,n("Non participé")]))])]),j(_,{to:"/cjmobile"},{default:A(()=>[ne]),_:1})],64)}}};export{ie as default};
